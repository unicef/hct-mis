{% extends "admin_extra_urls/action_page.html" %}{% load engine i18n admin_urls static admin_modify jsonfy %}
{% block extrastyle %}{{ block.super }}
  {#  {{ form.media }}#}
  <script src="{% static "admin/js/vendor/jquery/jquery.js" %}"></script>
  <script src="{% static "admin/js/jquery.init.js" %}"></script>
  <style>
    .toggler {
      cursor: pointer;
    }
  </style>
  <style>
    pre {
      line-height: 125%;
    }

    td.linenos .normal {
      color: inherit;
      background-color: transparent;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos {
      color: inherit;
      background-color: transparent;
      padding-left: 5px;
      padding-right: 5px;
    }

    td.linenos .special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    span.linenos.special {
      color: #000000;
      background-color: #ffffc0;
      padding-left: 5px;
      padding-right: 5px;
    }

    .hll {
      background-color: #ffffcc
    }

    .c {
      color: #888888
    }

    /* Comment */
    .err {
      color: #FF0000;
      background-color: #FFAAAA
    }

    /* Error */
    .k {
      color: #008800;
      font-weight: bold
    }

    /* Keyword */
    .o {
      color: #333333
    }

    /* Operator */
    .ch {
      color: #888888
    }

    /* Comment.Hashbang */
    .cm {
      color: #888888
    }

    /* Comment.Multiline */
    .cp {
      color: #557799
    }

    /* Comment.Preproc */
    .cpf {
      color: #888888
    }

    /* Comment.PreprocFile */
    .c1 {
      color: #888888
    }

    /* Comment.Single */
    .cs {
      color: #cc0000;
      font-weight: bold
    }

    /* Comment.Special */
    .gd {
      color: #A00000
    }

    /* Generic.Deleted */
    .ge {
      font-style: italic
    }

    /* Generic.Emph */
    .gr {
      color: #FF0000
    }

    /* Generic.Error */
    .gh {
      color: #000080;
      font-weight: bold
    }

    /* Generic.Heading */
    .gi {
      color: #00A000
    }

    /* Generic.Inserted */
    .go {
      color: #888888
    }

    /* Generic.Output */
    .gp {
      color: #c65d09;
      font-weight: bold
    }

    /* Generic.Prompt */
    .gs {
      font-weight: bold
    }

    /* Generic.Strong */
    .gu {
      color: #800080;
      font-weight: bold
    }

    /* Generic.Subheading */
    .gt {
      color: #0044DD
    }

    /* Generic.Traceback */
    .kc {
      color: #008800;
      font-weight: bold
    }

    /* Keyword.Constant */
    .kd {
      color: #008800;
      font-weight: bold
    }

    /* Keyword.Declaration */
    .kn {
      color: #008800;
      font-weight: bold
    }

    /* Keyword.Namespace */
    .kp {
      color: #003388;
      font-weight: bold
    }

    /* Keyword.Pseudo */
    .kr {
      color: #008800;
      font-weight: bold
    }

    /* Keyword.Reserved */
    .kt {
      color: #333399;
      font-weight: bold
    }

    /* Keyword.Type */
    .m {
      color: #6600EE;
      font-weight: bold
    }

    /* Literal.Number */
    .s {
      background-color: #fff0f0
    }

    /* Literal.String */
    .na {
      color: #0000CC
    }

    /* Name.Attribute */
    .nb {
      color: #007020
    }

    /* Name.Builtin */
    .nc {
      color: #BB0066;
      font-weight: bold
    }

    /* Name.Class */
    .no {
      color: #003366;
      font-weight: bold
    }

    /* Name.Constant */
    .nd {
      color: #555555;
      font-weight: bold
    }

    /* Name.Decorator */
    .ni {
      color: #880000;
      font-weight: bold
    }

    /* Name.Entity */
    .ne {
      color: #FF0000;
      font-weight: bold
    }

    /* Name.Exception */
    .nf {
      color: #0066BB;
      font-weight: bold
    }

    /* Name.Function */
    .nl {
      color: #997700;
      font-weight: bold
    }

    /* Name.Label */
    .nn {
      color: #0e84b5;
      font-weight: bold
    }

    /* Name.Namespace */
    .nt {
      color: #007700
    }

    /* Name.Tag */
    .nv {
      color: #996633
    }

    /* Name.Variable */
    .ow {
      color: #000000;
      font-weight: bold
    }

    /* Operator.Word */
    .w {
      color: #bbbbbb
    }

    /* Text.Whitespace */
    .mb {
      color: #6600EE;
      font-weight: bold
    }

    /* Literal.Number.Bin */
    .mf {
      color: #6600EE;
      font-weight: bold
    }

    /* Literal.Number.Float */
    .mh {
      color: #005588;
      font-weight: bold
    }

    /* Literal.Number.Hex */
    .mi {
      color: #0000DD;
      font-weight: bold
    }

    /* Literal.Number.Integer */
    .mo {
      color: #4400EE;
      font-weight: bold
    }

    /* Literal.Number.Oct */
    .sa {
      background-color: #fff0f0
    }

    /* Literal.String.Affix */
    .sb {
      background-color: #fff0f0
    }

    /* Literal.String.Backtick */
    .sc {
      color: #0044DD
    }

    /* Literal.String.Char */
    .dl {
      background-color: #fff0f0
    }

    /* Literal.String.Delimiter */
    .sd {
      color: #DD4422
    }

    /* Literal.String.Doc */
    .s2 {
      background-color: #fff0f0
    }

    /* Literal.String.Double */
    .se {
      color: #666666;
      font-weight: bold;
      background-color: #fff0f0
    }

    /* Literal.String.Escape */
    .sh {
      background-color: #fff0f0
    }

    /* Literal.String.Heredoc */
    .si {
      background-color: #eeeeee
    }

    /* Literal.String.Interpol */
    .sx {
      color: #DD2200;
      background-color: #fff0f0
    }

    /* Literal.String.Other */
    .sr {
      color: #000000;
      background-color: #fff0ff
    }

    /* Literal.String.Regex */
    .s1 {
      background-color: #fff0f0
    }

    /* Literal.String.Single */
    .ss {
      color: #AA6600
    }

    /* Literal.String.Symbol */
    .bp {
      color: #007020
    }

    /* Name.Builtin.Pseudo */
    .fm {
      color: #0066BB;
      font-weight: bold
    }

    /* Name.Function.Magic */
    .vc {
      color: #336699
    }

    /* Name.Variable.Class */
    .vg {
      color: #dd7700;
      font-weight: bold
    }

    /* Name.Variable.Global */
    .vi {
      color: #3333BB
    }

    /* Name.Variable.Instance */
    .vm {
      color: #996633
    }

    /* Name.Variable.Magic */
    .il {
      color: #0000DD;
      font-weight: bold
    }

    /* Literal.Number.Integer.Long */</style>
{% endblock %}
{% block breadcrumbs-active %}&rsaquo;<a href="{% url opts|admin_urlname:'test' original.pk %}">Test</a>{% endblock %}

{% block action-content %}
  {% if form %}
    <form method="post" enctype="multipart/form-data">
      {% csrf_token %}
{#      <table>#}
        {{ form.errors }}
        {{ form.opt }}
        <label><input type="radio" name="opt" class="optFile" checked value="optFile"> File </label>
        <label><input type="radio" name="opt" class="optData" value="optData"> Data </label>
        <label><input type="radio" name="opt" class="optContentType" value="optContentType"> ContentType </label>
        <div style="margin: 10px">
          <div id="optFile" style="display: block" class="options">
            {{ form.file }}
          </div>
          <div id="optData" style="display: none" class="options">
            {{ form.raw_data }}
          </div>
          <div id="optContentType" style="display: none" class="options">
            <table>
              <tr><th>Target</th><td>{{ form.content_type }}</td> </tr>
              <tr><th>Filters</th><td>{{ form.content_type_filters }}</td> </tr>
            </table>
          </div>
        </div>
{#      </table>#}
      <input type="submit" value="Test">
    </form>
  {% endif %}
  {% if results %}
    <table style="font-size: 20px;width: 100%">
      {% for data, result, success in results %}
        <tr style="background-color: {% if success %}darkseagreen{% else %}#e1adad{% endif %}">
          <td>{{ forloop.counter }}</td>
          <td>{{ result }}
            <div id="data{{ forloop.counter }}" style="display: none">
              <pre style="background-color: white;padding: 5px;">
                {{ data|repr }}
                {{ data|smart_json }}
              </pre>
            </div>
          </td>
          <td style="width: 3%">
            <div class="toggler" data-bind="#data{{ forloop.counter }}">+</div>
          </td>
        </tr>
      {% endfor %}
    </table>
  {% endif %}
{% endblock %}
{% block document_ready %}{{ block.super }}
  <script>
    (function ($) {
      $("input[type=radio]").on("click", function (e) {
        $('.options').hide();
        var $target = $('#' + $(this).val());
        $('#id_opt').val($(this).val());
        $target.show();
      });
      $(".toggler").on("click", function (e) {
        var $x = $($(this).data("bind"));
        if ($(this).html() === "+") {
          $x.show();
          $(this).html("-");
        } else {
          $x.hide();
          $(this).html("+");
        }
      });
      {% if form.opt.value  %}
        $('input[type=radio].{{ form.opt.value }}').click();
{#      {% else %}#}
{#        $('input[type=radio].optFile').click();#}
      {% endif %}
    })(django.jQuery);
  </script>
{% endblock %}
