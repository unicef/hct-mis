apiVersion: v1
kind: Secret
metadata:
  name: {{ include "hope.fullname" . }}-job-backend
  labels:
    {{- include "hope.labels" . | nindent 4 }}
  annotations:
    "helm.sh/hook": pre-upgrade
    "helm.sh/hook-weight": "-5"
    "helm.sh/hook-delete-policy": hook-succeeded,before-hook-creation
type: Opaque
data:
  {{- include "hope.postgresql.password" . | nindent 2 }}
  {{- include "hope.registrationdatahubpostgresql.password" . | nindent 2 }}
  {{- include "hope.cashassistdatahubpostgresql.password" . | nindent 2 }}
{{- range $key, $value :=  .Values.backend.secret }}
{{- if eq "bool" (typeOf $value) }}
{{- $stringValue := $value | toString }}
  {{ $key }}: {{ $stringValue | b64enc | quote }}
{{- else }}
  {{- if eq $value "" }}
  {{- else }}
  {{ $key }}: {{ $value | b64enc | quote }}
  {{- end }}
{{- end }}
{{- end }}
